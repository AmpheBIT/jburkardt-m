<html>

  <head>
    <title>
      SIR_SIMULATION - Simulation of Disease Propagation with the SIR Model
    </title>
  </head>

  <body bgcolor="#EEEEEE" link="#CC0000" alink="#FF3300" vlink="#000055">

    <h1 align = "center">
      SIR_SIMULATION <br> Simulation of Disease Propagation with the SIR Model
    </h1>

    <hr>

    <p>
      <b>SIR_SIMULATION</b>
      is a MATLAB program which
      simulates the spread of a disease through a hospital room of M by N beds,
      using the SIR (Susceptible/Infected/Recovered) model.
    </p>

    <p>
      We consider the evolution of a disease in a hospital
      in which patients are arranged on an array of beds.
    </p>

    <p>
      We assume that the beds form an array of M rows and N columns, so that
      there are a total of M * N patients.
    </p>

    <p>
      We assume that the patients can be classified as Susceptible, Infected or
      Recovering, with the properties that:
      <ul>
        <li>
          <i>Susceptible</i>: A patient who has never been infected with the
          disease.  A susceptible patient can get the disease.
        </li>
        <li>
          <i>Infected</i>: A patient who has never gotten the disease.
          A patient stays infected for K days.  On the K+1 of the disease,
          the patient "recovers".
        </li>
        <li>
          <i>Recovered</i>: A patient who has had the disease, that is,
          has caught the disease and been sick for a full K days.  A recovered
          patient never gets sick again.
        </li>
      </ul>
    </p>

    <p>
      We set up an M by N array <b>A</b> to represent the patients.
      A(I,J) contains information on the patient in row I, column J.
      A(I,J) will be
      <ul>
        <li>
          0, if the patient is susceptible.
        </li>
        <li>
          a value between 1 and K, if the patient is infected.  The value
          is the number of days the patient has been infected.
        </li>
        <li>
          -1, if the patient is recovered.
        </li>
      </ul>
    </p>

    <p>
      The rules for transmission of the disease essentially update the
      patient array once a day.  If patient A(I,J) was:
      <ul>
        <li>
          0, then check the four neighbors A(I-1,J), A(I+1,J), A(I,J-1)
          and A(I,J+1).  For each neighbor that is infected, pick a random
          number, and if that random number is less than TAU, then patient
          A(I,J) becomes infected, that is, we set A(I,J) to 1.
        </li>
        <li>
          a value between 1 and K, then the value is increased by 1.
          But if the value was already K, it is now reset to -1, because the
          patient has recovered.
        </li>
        <li>
          -1, nothing happens.
        </li>
      </ul>
    </p>

    <p>
      Quantities of interest include an animation of the day to day status
      of patients in the hospital (the "geometry") and the values of S, I, and R,
      that is, the total number of patients in each category, as it evolves 
      over time.
    </p>

    <p>
      Since this problem contains a probabilistic element in the transmission of
      disease, the outcome of any single run has limited meaning.  It is much
      more valuable to run many simulations, and thus to get both average or "expected"
      values, as well as a feeling for the variance of the data from these averages.
    </p>

    <h3 align = "center">
      Usage:
    </h3>

    <p>
      <blockquote>
        <i>sir</i> = <b>sir_simulation</b> ( <i>m</i>, <i>n</i>, <i>a</i>, <i>k</i>, 
          <i>tau</i>, <i>t_max</i> )
      </blockquote>
      where
      <ul>
        <li>
          <i>m</i> is the number of rows of patients.
        </li>
        <li>
          <i>n</i> is the number of columns of patients.
        </li>
        <li>
          <i>a</i> is the M by N matrix of the initial patient states.
        </li>
        <li>
          <i>k</i> is the number of days a patient stays infected.
        </li>
        <li>
          <i>tau</i> is the probability that a susceptible patient will become infected
          because of one "nearby" infected patient (north, south, east or west)
          over one day.
        </li>
        <li>
          <i>t_max</i> is the total number of days to consider, counting the initial
          condition as day 1.
        </li>
      </ul>
    </p>

    <h3 align = "center">
      Licensing:
    </h3>

    <p>
      The computer code and data files described and made available on this web page 
      are distributed under
      <a href = "../../txt/gnu_lgpl.txt">the GNU LGPL license.</a>
    </p>

    <h3 align = "center">
      Related Data and Programs:
    </h3>

    <p>
      <a href = "../../m_src/brownian_motion_simulation/brownian_motion_simulation.html">
      BROWNIAN_MOTION_SIMULATION</a>,
      a MATLAB program which
      simulates Brownian motion in an M-dimensional region.
    </p>

    <p>
      <a href = "../../m_src/dice_simulation/dice_simulation.html">
      DICE_SIMULATION</a>, 
      a MATLAB program which
      simulates N tosses of M dice, making a histogram of the results.
    </p>

    <p>
      <a href = "../../m_src/duel_simulation/duel_simulation.html">
      DUEL_SIMULATION</a>, 
      a MATLAB program which
      simulates N repetitions of a duel between two players, each of
      whom has a known firing accuracy.
    </p>

    <p>
      <a href = "../../c_src/forest_fire_simulation/forest_fire_simulation.html">
      FOREST_FIRE_SIMULATION</a>,
      a C program which
      simulates the occurrence of fires and regrowth in a forest,
      displaying the results using X Windows,
      by Michael Creutz.
    </p>

    <p>
      <a href = "../../m_src/gamblers_ruin_simulation/gamblers_ruin_simulation.html">
      GAMBLERS_RUIN_SIMULATION</a>,
      a MATLAB program which
      simulates the game of gambler's ruin.
    </p>

    <p>
      <a href = "../../m_src/high_card_simulation/high_card_simulation.html">
      HIGH_CARD_SIMULATION</a>,
      a MATLAB program which
      simulates a situation in which you see the cards in a deck one by one,
      and must select the one you think is the highest and stop. 
    </p>

    <p>
      <a href = "../../m_src/ising_2d_simulation/ising_2d_simulation.html">
      ISING_2D_SIMULATION</a>,
      a MATLAB program which
      carries out a Monte Carlo simulation of an Ising model,
      a 2D array of positive and negative charges,
      each of which is likely to "flip" to be in agreement with neighbors.
    </p>

    <p>
      <a href = "../../c_src/life_opengl/life_opengl.html">
      LIFE_OPENGL</a>, 
      a C program which
      uses OpenGL to display the evolution of John Conway's "Game of Life",
      by Simon Green.
    </p>

    <p>
      <a href = "../../m_src/lorenz_simulation/lorenz_simulation.html">
      LORENZ_SIMULATION</a>,
      a MATLAB program which
      solves the Lorenz equations and displays the solution, for various
      starting conditions.
    </p>

    <p>
      <a href = "../../f_src/md1/md1.html">
      MD1</a>, 
      a FORTRAN90 program which 
      carries out a simple molecular dynamics simulation;
    </p>

    <p>
      <a href = "../../f_src/md2/md2.html">
      MD2</a>, 
      a FORTRAN90 program which 
      carries out a simple molecular dynamics simulation;
    </p>

    <p>
      <a href = "../../f_src/md3/md3.html">
      MD3</a>, 
      a FORTRAN90 program which 
      carries out a simple molecular dynamics simulation;
    </p>

    <p>
      <a href = "../../f_src/md3glue/md3glue.html">
      MD3GLUE</a>, 
      a FORTRAN90 program which 
      carries out a simple molecular dynamics simulation;
    </p>

    <p>
      <a href = "../../m_src/poisson_simulation/poisson_simulation.html">
      POISSON_SIMULATION</a>,
      a MATLAB library which
      simulates a Poisson process in which events randomly occur with an
      average waiting time of Lambda.
    </p>

    <p>
      <a href = "../../m_src/random_walk_1d_simulation/random_walk_1d_simulation.html">
      RANDOM_WALK_1D_SIMULATION</a>,
      a MATLAB program which
      simulates a random walk in a 1-dimensional region.
    </p>

    <p>
      <a href = "../../m_src/random_walk_2d_avoid_simulation/random_walk_2d_avoid_simulation.html">
      RANDOM_WALK_2D_AVOID_SIMULATION</a>,
      a MATLAB program which
      simulates a self-avoiding random walk in a 2-dimensional region.
    </p>

    <p>
      <a href = "../../m_src/random_walk_2d_simulation/random_walk_2d_simulation.html">
      RANDOM_WALK_2D_SIMULATION</a>,
      a MATLAB program which
      simulates a random walk in a 2-dimensional region.
    </p>

    <p>
      <a href = "../../m_src/random_walk_3d_simulation/random_walk_3d_simulation.html">
      RANDOM_WALK_3D_SIMULATION</a>,
      a MATLAB program which
      simulates a random walk in a 3-dimensional region.
    </p>

    <p>
      <a href = "../../m_src/reactor_simulation/reactor_simulation.html">
      REACTOR_SIMULATION</a>,
      a MATLAB program which
      a simple Monte Carlo simulation of the shielding effect of a slab
      of a certain thickness in front of a neutron source.  This program was
      provided as an example with the book "Numerical Methods and Software."
    </p>

    <p>
      <a href = "../../m_src/three_body_simulation/three_body_simulation.html">
      THREE_BODY_SIMULATION</a>,
      a MATLAB program which
      simulates the behavior of three planets, constrained to lie in a plane,
      and moving under the influence of gravity,
      by Walter Gander and Jiri Hrebicek.
    </p>

    <p>
      <a href = "../../m_src/traffic_simulation/traffic_simulation.html">
      TRAFFIC_SIMULATION</a>,
      a MATLAB program which
      simulates the cars waiting to get through a traffic light.
    </p>

    <p>
      <a href = "../../m_src/truel_simulation/truel_simulation.html">
      TRUEL_SIMULATION</a>,
      a MATLAB program which
      simulates N repetitions of a duel between three players, each of
      whom has a known firing accuracy.
    </p>

    <p>
      <a href = "../../c_src/xising/xising.html">
      XISING</a>, 
      a C program which
      models the variations in ferromagnetism in a material, displaying
      the results using X Windows.
    </p>

    <p>
      <a href = "../../c_src/xwaves/xwaves.html">
      XWAVES</a>, 
      a C program which
      simulates the behavior of solutions of certain forms of the wave equation, displaying
      the results using X Windows.
    </p>

    <h3 align = "center">
      Reference:
    </h3>

    <p>
      <ol>
        <li>
          Dianne OLeary,<br>
          Models of Infection: Person to Person,<br>
          Computing in Science and Engineering,<br>
          Volume 6, Number 1, January/February 2004.
        </li>
        <li>
          Dianne OLeary,<br>
          Scientific Computing with Case Studies,<br>
          SIAM, 2008,<br>
          ISBN13: 978-0-898716-66-5,<br>
          LC: QA401.O44.
        </li>
      </ol>
    </p>

    <h3 align = "center">
      Source Code:
    </h3>

    <p>
      <ul>
        <li>
          <a href = "sir_area_display.m">sir_area_display.m</a>, 
          displays an area plot of the SIR percentages over time.
        </li>
        <li>
          <a href = "sir_line_display.m">sir_line_display.m</a>,
          displays a line plot of the SIR percentages over time.
        </li>
        <li>
          <a href = "sir_simulation.m">sir_simulation.m</a>, 
          the main program, which takes user parameter values,
          computes the configuration for each time step, 
          displays an image of the configuration for each time,
          and returns the SIR percentages.
        </li>
        <li>
          <a href = "timestep_display.m">timestep_display.m</a>,
          displays an image of the hospital room at each timestep,
          indicating the locations of suceptible, infected, and recovered
          patients.
        </li>
      </ul>
    </p>

    <h3 align = "center">
      Examples and Tests:
    </h3>

    <p>
      As the SIR_SIMULATION program runs, it displays a plot of the
      hospital room, with susceptibles in green, infecteds in shades of red,
      and recovereds in gray.  Here is an example:
      <ul>
        <li>
          <a href = "sir_day13.png">sir_day13.png</a>, 
          a plot of the patient status array on day 13,
          with M = N = 10, a single infected patient at A(5,5),
          K = 4, TAU = 0.2, and T_MAX = 50,
        </li>
      </ul>
    </p>

    <p>
      Using the command
      <pre>
      plot ( 1:t_max, sir(1,:), 'g', 1:t_max, sir(2,:), 'r', 1:t_max, sir(3,:), 'k' )
      </pre>
      we can make line plots of the S, I and R populations.  For M = N = 10,
      a single infected patient at A(5,5), K = 4, TAU = 0.2, and T_MAX = 50,
      we did this several times:
      <ul>
        <li>
          <a href = "sir_line1.png">sir_line1.png</a>
        </li>
        <li>
          <a href = "sir_line2.png">sir_line2.png</a>
        </li>
        <li>
          <a href = "sir_line3.png">sir_line3.png</a>
        </li>
        <li>
          <a href = "sir_line4.png">sir_line4.png</a>
        </li>
        <li>
          <a href = "sir_line5.png">sir_line5.png</a>
        </li>
        <li>
          <a href = "sir_line6.png">sir_line6.png</a>
        </li>
      </ul>
    </p>

    <p>
      Using the commands
      <pre>
      h = areas ( sir' );
      set ( h(1), 'FaceColor', [ 0, 1, 0 ] );
      set ( h(2), 'FaceColor', [ 1, 0, 0 ] );
      set ( h(3), 'FaceColor', [ 0.8, 0.8, 0.8 ] );
      </pre>
      we can make an area plot of the S, I and R populations.  For M = N = 10,
      a single infected patient at A(5,5), K = 4, TAU = 0.2, and T_MAX = 50,
      we did this:
      <ul>
        <li>
          <a href = "sir_area.png">sir_area.png</a>
        </li>
      </ul>
    </p>

    <p>
      You can go up one level to <a href = "../m_src.html">
      the MATLAB source codes</a>.
    </p>

    <hr>

    <i>
      Last revised on 09 November 2009.
    </i>

    <!-- John Burkardt -->

  </body>

</html>
