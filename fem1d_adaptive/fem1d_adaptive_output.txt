>> fem1d_adaptive
06-Nov-2006 08:22:06

FEM1D_ADAPTIVE
  MATLAB version

Solve the two-point boundary value problem:

  -d/dx ( P(x) * dU(x)/dx ) + Q(x) * U(x)  =  F(x)

on the interval [0,1], specifying the value
of U at each endpoint.

The number of basis functions per element is 2

The number of quadrature points per element is 2

  Problem index = 6


  "ARCTAN" problem:

  U(X) =  ATAN((X-0.5)/A)
  P(X) =  1.0
  Q(X) =  0.0
  F(X) =  2*A*(X-0.5)/(A^2+(X-0.5)^2)^2
  IBC  =  3
  UL   =  ATAN(-0.5/A)
  UR   =  ATAN( 0.5/A)
  A    = 0.010000

Arctangent problem
The equation is to be solved for
X greater than 0.000000
 and less than 1.000000

The boundary conditions are:

  At X = XL, U = -1.550799
  At X = XR, U = 1.550799

Begin new iteration with 4 nodes.


Printout of tridiagonal linear system:

Equation  A-Left  A-Diag  A-Rite  RHS

  1                    8.000000     -4.000000     -9.875060
  2     -4.000000      8.000000     -4.000000      0.000000
  3     -4.000000      8.000000                    9.875060

Basic solution

Node    X(I)        U(X(I))        Uexact        Error

     0      0.000000     -1.550799     -1.550799      0.000000
     1      0.250000     -1.234382     -1.530818      0.296435
     2      0.500000     -0.000000      0.000000     -0.000000
     3      0.750000      1.234382      1.530818     -0.296435
     4      1.000000      1.550799      1.550799      0.000000

ETA

      0.244233
      2.196335
      2.196335
      0.244233

Tolerance = 1.464351

Subdivide interval 2
Subdivide interval 3

Begin new iteration with 6 nodes.


Basic solution

Node    X(I)        U(X(I))        Uexact        Error

     0      0.000000     -1.550799     -1.550799      0.000000
     1      0.250000     -1.572694     -1.530818     -0.041876
     2      0.375000     -1.553638     -1.490966     -0.062671
     3      0.500000     -0.000000      0.000000     -0.000000
     4      0.625000      1.553638      1.490966      0.062671
     5      0.750000      1.572694      1.530818      0.041876
     6      1.000000      1.550799      1.550799      0.000000

ETA

      0.009444
      0.185938
      3.526846
      3.526846
      0.185938
      0.009444

Tolerance = 1.488901

Subdivide interval 3
Subdivide interval 4

Begin new iteration with 8 nodes.


Basic solution

Node    X(I)        U(X(I))        Uexact        Error

     0      0.000000     -1.550799     -1.550799      0.000000
     1      0.250000     -1.744159     -1.530818     -0.213342
     2      0.375000     -1.810836     -1.490966     -0.319870
     3      0.437500     -1.785029     -1.412141     -0.372888
     4      0.500000     -0.000000      0.000000     -0.000000
     5      0.562500      1.785029      1.412141      0.372888
     6      0.625000      1.810836      1.490966      0.319870
     7      0.750000      1.744159      1.530818      0.213342
     8      1.000000      1.550799      1.550799      0.000000

ETA

      0.009444
      0.026573
      0.292454
      3.343300
      3.343300
      0.292454
      0.026573
      0.009444

Tolerance = 1.101541

Subdivide interval 4
Subdivide interval 5

Begin new iteration with 10 nodes.


Basic solution

Node    X(I)        U(X(I))        Uexact        Error

     0      0.000000     -1.550799     -1.550799      0.000000
     1      0.250000     -1.564034     -1.530818     -0.033217
     2      0.375000     -1.540648     -1.490966     -0.049682
     3      0.437500     -1.469810     -1.412141     -0.057669
     4      0.468750     -1.322539     -1.261093     -0.061446
     5      0.500000      0.000000      0.000000      0.000000
     6      0.531250      1.322539      1.261093      0.061446
     7      0.562500      1.469810      1.412141      0.057669
     8      0.625000      1.540648      1.490966      0.049682
     9      0.750000      1.564034      1.530818      0.033217
    10      1.000000      1.550799      1.550799      0.000000

ETA

      0.009444
      0.026573
      0.073637
      0.235021
      2.822379
      2.822379
      0.235021
      0.073637
      0.026573
      0.009444

Tolerance = 0.760103

Subdivide interval 5
Subdivide interval 6

Begin new iteration with 12 nodes.


Basic solution

Node    X(I)        U(X(I))        Uexact        Error

     0      0.000000     -1.550799     -1.550799      0.000000
     1      0.250000     -1.512161     -1.530818      0.018657
     2      0.375000     -1.462838     -1.490966      0.028128
     3      0.437500     -1.379032     -1.412141      0.033109
     4      0.468750     -1.225277     -1.261093      0.035817
     5      0.484375     -0.964992     -1.001483      0.036491
     6      0.500000      0.000000      0.000000      0.000000
     7      0.515625      0.964992      1.001483     -0.036491
     8      0.531250      1.225277      1.261093     -0.035817
     9      0.562500      1.379032      1.412141     -0.033109
    10      0.625000      1.462838      1.490966     -0.028128
    11      0.750000      1.512161      1.530818     -0.018657
    12      1.000000      1.550799      1.550799      0.000000

ETA

      0.009444
      0.026573
      0.073637
      0.192415
      0.416090
      1.831096
      1.831096
      0.416090
      0.192415
      0.073637
      0.026573
      0.009444

Tolerance = 0.509861

Subdivide interval 6
Subdivide interval 7

Begin new iteration with 14 nodes.


Basic solution

Node    X(I)        U(X(I))        Uexact        Error

     0      0.000000     -1.550799     -1.550799      0.000000
     1      0.250000     -1.528725     -1.530818      0.002092
     2      0.375000     -1.487685     -1.490966      0.003282
     3      0.437500     -1.408019     -1.412141      0.004122
     4      0.468750     -1.256334     -1.261093      0.004759
     5      0.484375     -0.997085     -1.001483      0.004398
     6      0.492188     -0.660270     -0.663203      0.002933
     7      0.500000      0.000000      0.000000      0.000000
     8      0.507813      0.660270      0.663203     -0.002933
     9      0.515625      0.997085      1.001483     -0.004398
    10      0.531250      1.256334      1.261093     -0.004759
    11      0.562500      1.408019      1.412141     -0.004122
    12      0.625000      1.487685      1.490966     -0.003282
    13      0.750000      1.528725      1.530818     -0.002092
    14      1.000000      1.550799      1.550799      0.000000

ETA

      0.009444
      0.026573
      0.073637
      0.192415
      0.410124
      0.512307
      0.653928
      0.653928
      0.512307
      0.410124
      0.192415
      0.073637
      0.026573
      0.009444

Tolerance = 0.322026

Subdivide interval 5
Subdivide interval 6
Subdivide interval 7
Subdivide interval 8
Subdivide interval 9
Subdivide interval 10

Begin new iteration with 20 nodes.


Basic solution

Node    X(I)        U(X(I))        Uexact        Error

     0      0.000000     -1.550799     -1.550799      0.000000
     1      0.250000     -1.529415     -1.530818      0.001403
     2      0.375000     -1.488719     -1.490966      0.002247
     3      0.437500     -1.409226     -1.412141      0.002915
     4      0.468750     -1.257628     -1.261093      0.003466
     5      0.476563     -1.164900     -1.167515      0.002615
     6      0.484375     -0.999675     -1.001483      0.001808
     7      0.488281     -0.863012     -0.864370      0.001358
     8      0.492188     -0.662316     -0.663203      0.000887
     9      0.496094     -0.372028     -0.372398      0.000371
    10      0.500000     -0.000000      0.000000     -0.000000
    11      0.503906      0.372028      0.372398     -0.000371
    12      0.507813      0.662316      0.663203     -0.000887
    13      0.511719      0.863012      0.864370     -0.001358
    14      0.515625      0.999675      1.001483     -0.001808
    15      0.523438      1.164900      1.167515     -0.002615
    16      0.531250      1.257628      1.261093     -0.003466
    17      0.562500      1.409226      1.412141     -0.002915
    18      0.625000      1.488719      1.490966     -0.002247
    19      0.750000      1.529415      1.530818     -0.001403
    20      1.000000      1.550799      1.550799      0.000000

ETA

      0.009444
      0.026573
      0.073637
      0.192422
      0.094285
      0.209540
      0.143922
      0.220710
      0.276384
      0.151308
      0.151308
      0.276384
      0.220710
      0.143922
      0.209540
      0.094285
      0.192422
      0.073637
      0.026573
      0.009444

Tolerance = 0.167797

Subdivide interval 4
Subdivide interval 6
Subdivide interval 8
Subdivide interval 9
Subdivide interval 12
Subdivide interval 13
Subdivide interval 15
Subdivide interval 17

Begin new iteration with 28 nodes.


Basic solution

Node    X(I)        U(X(I))        Uexact        Error

     0      0.000000     -1.550799     -1.550799      0.000000
     1      0.250000     -1.529819     -1.530818      0.000999
     2      0.375000     -1.489325     -1.490966      0.001641
     3      0.437500     -1.409933     -1.412141      0.002208
     4      0.453125     -1.358934     -1.360614      0.001680
     5      0.468750     -1.259832     -1.261093      0.001261
     6      0.476563     -1.166560     -1.167515      0.000954
     7      0.480469     -1.096809     -1.097595      0.000785
     8      0.484375     -1.000866     -1.001483      0.000617
     9      0.488281     -0.863924     -0.864370      0.000447
    10      0.490234     -0.773179     -0.773541      0.000362
    11      0.492188     -0.662927     -0.663203      0.000276
    12      0.494141     -0.529825     -0.530015      0.000190
    13      0.496094     -0.372295     -0.372398      0.000104
    14      0.500000     -0.000000      0.000000     -0.000000
    15      0.503906      0.372295      0.372398     -0.000104
    16      0.505859      0.529825      0.530015     -0.000190
    17      0.507813      0.662927      0.663203     -0.000276
    18      0.509766      0.773179      0.773541     -0.000362
    19      0.511719      0.863924      0.864370     -0.000447
    20      0.515625      1.000866      1.001483     -0.000617
    21      0.519531      1.096809      1.097595     -0.000785
    22      0.523438      1.166560      1.167515     -0.000954
    23      0.531250      1.259832      1.261093     -0.001261
    24      0.546875      1.358934      1.360614     -0.001680
    25      0.562500      1.409933      1.412141     -0.002208
    26      0.625000      1.489325      1.490966     -0.001641
    27      0.750000      1.529819      1.530818     -0.000999
    28      1.000000      1.550799      1.550799      0.000000

ETA

      0.009444
      0.026573
      0.073643
      0.040325
      0.105528
      0.094199
      0.059061
      0.091140
      0.143922
      0.070682
      0.085315
      0.096668
      0.096701
      0.151307
      0.151307
      0.096701
      0.096668
      0.085315
      0.070682
      0.143922
      0.091140
      0.059061
      0.094199
      0.105528
      0.040325
      0.073643
      0.026573
      0.009444

Tolerance = 0.098110

Subdivide interval 5
Subdivide interval 9
Subdivide interval 14
Subdivide interval 15
Subdivide interval 20
Subdivide interval 24

The iterations did not reach their goal.
The next value of N is 34
which exceeds NMAX = 30

FEM1D_ADAPTIVE:
  Normal end of execution.

06-Nov-2006 08:22:11
>> 