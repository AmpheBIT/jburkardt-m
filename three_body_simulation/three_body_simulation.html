<html>

  <head>
    <title>
      THREE_BODY_SIMULATION - Planar Three Body Problem Simulation
    </title>
  </head>

  <body bgcolor="#eeeeee" link="#cc0000" alink="#ff3300" vlink="#000055">

    <h1 align = "center">
      THREE_BODY_SIMULATION <br> Planar Three Body Problem Simulation
    </h1>

    <hr>

    <p>
      <b>THREE_BODY_SIMULATION</b>
      is a MATLAB library which
      simulates the solution of the planar three body problem.
    </p>

    <p>
      Three bodies, regarded as point masses, are constrained to lie in a plane.
      The masses of each body are given, as are the positions and velocities
      at a starting time T = 0.  The bodies move in accordance with the gravitational
      force between them.
    </p>

    <p>
      The force exerted on the 0-th body by the 1st body can be written:
      <pre>
        F = - m0 m1 ( p0 - p1 ) / |p0 - p1|^3
      </pre>
      assuming that units have been normalized to that the gravitational
      coefficient is 1.  Newton's laws of motion can be written:
      <pre>  
        m0 p0'' = - m0 m1 ( p0 - p1 ) / |p0 - p1|^3 
                  - m0 m2 ( p0 - p2 ) / |p0 - p2|^3
  
        m1 p1'' = - m1 m0 ( p1 - p0 ) / |p1 - p0|^3 
                  - m1 m2 ( p1 - p2 ) / |p1 - p2|^3
  
        m2 p2'' = - m2 m0 ( p2 - p0 ) / |p2 - p0|^3 
                  - m2 m1 ( p2 - p1 ) / |p2 - p1|^3
      </pre>
    </p>

    <p>
      Letting
      <pre>
        y1 = p0(x)
        y2 = p0(y)
        y3 = p0'(x)
        y4 = p0'(y)
      </pre>
      and using similar definitions for p1 and p2, the 3 second order vector 
      equations can be rewritten as 12 first order equations.  In particular,
      the first four are:
      <pre>
        y1' = y3
        y2' = y4
        y3' = - m1 ( y1 - y5  ) / |(y1,y2) - (y5,y6) |^3 
              - m2 ( y1 - y9  ) / |(y1,y2) - (y9,y10)|^3
        y4' = - m1 ( y2 - y6  ) / |(y1,y2) - (y5,y6) |^3 
              - m2 ( y2 - y10 ) / |(y1,y2) - (y9,y10)|^3
      </pre>
      and so on.
      This first order system can be integrated by a standard ODE solver.
    </p>

    <p>
      Note that when any two bodies come close together, the solution changes
      very rapidly, and very small steps must be taken by the ODE solver.
      For this system, the first near collision occurs around T=15.8299, and
      the results produced by MATLAB's ode113 will not be very accurate after
      that point.
    </p>

    <h3 align = "center">
      Licensing:
    </h3>

    <p>
      The computer code and data files described and made available on this web page
      are distributed under
      <a href = "../../txt/gnu_lgpl.txt">the GNU LGPL license.</a>
    </p>

    <h3 align = "center">
      Languages:
    </h3>

    <p>
      <b>THREE_BODY_SIMULATION</b> is available in
      <a href = "../../c_src/three_body_simulation/three_body_simulation.html">a C version</a> and
      <a href = "../../cpp_src/three_body_simulation/three_body_simulation.html">a C++ version</a> and
      <a href = "../../f77_src/three_body_simulation/three_body_simulation.html">a FORTRAN77 version</a> and
      <a href = "../../f_src/three_body_simulation/three_body_simulation.html">a FORTRAN90 version</a> and
      <a href = "../../m_src/three_body_simulation/three_body_simulation.html">a MATLAB version</a>.
    </p>

    <h3 align = "center">
      Related Data and Programs:
    </h3>

    <p>
      <a href = "../../m_src/brownian_motion_simulation/brownian_motion_simulation.html">
      BROWNIAN_MOTION_SIMULATION</a>,
      a MATLAB program which
      simulates Brownian motion in an M-dimensional region.
    </p>

    <p>
      <a href = "../../m_src/dice_simulation/dice_simulation.html">
      DICE_SIMULATION</a>,
      a MATLAB program which
      simulates N tosses of M dice, making a histogram of the results.
    </p>

    <p>
      <a href = "../../m_src/duel_simulation/duel_simulation.html">
      DUEL_SIMULATION</a>,
      a MATLAB program which
      simulates N repetitions of a duel between two players, each of
      whom has a known firing accuracy.
    </p>

    <p>
      <a href = "../../m_src/gamblers_ruin_simulation/gamblers_ruin_simulation.html">
      GAMBLERS_RUIN_SIMULATION</a>,
      a MATLAB program which
      simulates the game of gambler's ruin.
    </p>

    <p>
      <a href = "../../m_src/high_card_simulation/high_card_simulation.html">
      HIGH_CARD_SIMULATION</a>,
      a MATLAB program which
      simulates a situation in which you see the cards in a deck one by one,
      and must select the one you think is the highest and stop. 
    </p>

    <p>
      <a href = "../../m_src/ising_2d_simulation/ising_2d_simulation.html">
      ISING_2D_SIMULATION</a>,
      a MATLAB program which
      carries out a Monte Carlo simulation of an Ising model,
      a 2D array of positive and negative charges,
      each of which is likely to "flip" to be in agreement with neighbors.
    </p>

    <p>
      <a href = "../../m_src/lorenz_simulation/lorenz_simulation.html">
      LORENZ_SIMULATION</a>,
      a MATLAB program which
      solves the Lorenz equations and displays the solution, for various
      starting conditions.
    </p>

    <p>
      <a href = "../../m_src/poisson_simulation/poisson_simulation.html">
      POISSON_SIMULATION</a>,
      a MATLAB library which
      simulates a Poisson process in which events randomly occur with an
      average waiting time of Lambda.
    </p>

    <p>
      <a href = "../../m_src/random_walk_1d_simulation/random_walk_1d_simulation.html">
      RANDOM_WALK_1D_SIMULATION</a>,
      a MATLAB program which
      simulates a random walk in a 1-dimensional region.
    </p>

    <p>
      <a href = "../../m_src/random_walk_2d_avoid_simulation/random_walk_2d_avoid_simulation.html">
      RANDOM_WALK_2D_AVOID_SIMULATION</a>,
      a MATLAB program which
      simulates a self-avoiding random walk in a 2-dimensional region.
    </p>

    <p>
      <a href = "../../m_src/random_walk_2d_simulation/random_walk_2d_simulation.html">
      RANDOM_WALK_2D_SIMULATION</a>,
      a MATLAB program which
      simulates a random walk in a 2-dimensional region.
    </p>

    <p>
      <a href = "../../m_src/random_walk_3d_simulation/random_walk_3d_simulation.html">
      RANDOM_WALK_3D_SIMULATION</a>,
      a MATLAB program which
      simulates a random walk in a 3-dimensional region.
    </p>

    <p>
      <a href = "../../m_src/reactor_simulation/reactor_simulation.html">
      REACTOR_SIMULATION</a>,
      a MATLAB program which
      a simple Monte Carlo simulation of the shielding effect of a slab
      of a certain thickness in front of a neutron source.  This program was
      provided as an example with the book "Numerical Methods and Software."
    </p>

    <p>
      <a href = "../../m_src/rkf45/rkf45.html">
      RKF45</a>,
      a MATLAB library which
      implements the Runge-Kutta-Fehlberg ODE solver.
    </p>

    <p>
      <a href = "../../m_src/sir_simulation/sir_simulation.html">
      SIR_SIMULATION</a>,
      a MATLAB program which
      simulates the spread of a disease through a hospital room of M by N beds,
      using the SIR (Susceptible/Infected/Recovered) model.
    </p>

    <p>
      <a href = "../../m_src/traffic_simulation/traffic_simulation.html">
      TRAFFIC_SIMULATION</a>,
      a MATLAB program which
      simulates the cars waiting to get through a traffic light.
    </p>

    <p>
      <a href = "../../m_src/truel_simulation/truel_simulation.html">
      TRUEL_SIMULATION</a>,
      a MATLAB program which
      simulates N repetitions of a duel between three players, each of
      whom has a known firing accuracy.
    </p>

    <p>
      <a href = "../../m_src/two_body_simulation/two_body_simulation.html">
      TWO_BODY_SIMULATION</a>,
      a MATLAB program which
      simulates the behavior of two bodies, constrained to lie in a plane,
      moving under the influence of gravity, with one body much more massive 
      than the other.
    </p>

    <h3 align = "center">
      Author:
    </h3>

    <p>
      Dominik Gruntz, Joerg Waldvogel
    </p>

    <h3 align = "center">
      Reference:
    </h3>

    <p>
      <ol>
        <li>
          Dominik Gruntz, Joerg Waldvogel,<br>
          "Orbits in the Planar Three-Body Problem",<br>
          Walter Gander, Jiri Hrebicek,<br>
          Solving Problems in Scientific Computing using Maple and Matlab,<br>
          Springer, 1997,<br>
          ISBN: 3-540-61793-0,<br>
          LC: Q183.9.G36.
        </li>
      </ol>
    </p>

    <h3 align = "center">
      Source Code:
    </h3>

    <p>
      <b>SIMPLE</b> simulates the problem by immediately calling an ODE integrator.  This
      approach loses accuracy when the bodies come close to colliding, which is
      likely to happen often.
      <ul>
        <li>
          <a href = "simple_ode113.m">simple_ode113.m</a>,
          is a MATLAB script which simulates the problem by calling ODE113.
        </li>
        <li>
          <a href = "trajectory1.png">trajectory1.png</a>,
          an image of the first third of the trajectory.
        </li>
        <li>
          <a href = "trajectory2.png">trajectory2.png</a>,
          an image of the second third of the trajectory.
        </li>
        <li>
          <a href = "trajectory3.png">trajectory3.png</a>,
          an image of the last third of the trajectory.
        </li>
        <li>
          <a href = "trajectory.png">trajectory.png</a>,
          an image of the entire trajectory.
        </li>
        <li>
          <a href = "simple_rkf45.m">simple_rkf45.m</a>,
          is a MATLAB script which simulates the problem by calling RKF45.
        </li>
        <li>
          <a href = "simple_f.m">simple_f.m</a>,
          evaluates the right hand side of the ODE system.
        </li>
        <li>
          <a href = "timestamp.m">timestamp.m</a>,
          prints the current YMDHMS date as a time stamp.
        </li>
      </ul>
    </p>

    <p>
      <b>THREEBP</b> eliminates some variables by working in the center of mass
      coordinate system, and uses an approach suggested by Levi-Civita in which
      a new time scale is devised.  The transformed system of ODE's can be solved
      with greater accuracy.
      <ul>
        <li>
          <a href = "data3.mat">data3.mat</a>,
          a MAT data file containing the computational results
          T1 and Y1 for the simple approach, and S and Z for the
          transformed approach.
        </li>
        <li>
          <a href = "f.m">f.m</a>,
          evaluates the right hand side of the simple ODE system.
        </li>
        <li>
          <a href = "fig_data.m">fig_data.m</a>,
          creates plots from the book, using the data file.
        </li>
        <li>
          <a href = "gen_data.m">gen_data.m</a>,
          creates the data file, by solving the simple and transformed systems.
        </li>
        <li>
          <a href = "proc.m">proc.m</a>,
          computes the regularized Hamiltonian function K.
        </li>
        <li>
          <a href = "threebp.m">threebp.m</a>,
          evaluates the right hand side of the transformed ODE system.
        </li>
      </ul>
    </p>

    <p>
      You can go up one level to <a href = "../m_src.html">
      the MATLAB source codes</a>.
    </p>

    <hr>

    <i>
      Last modified on 05 November 2012.
    </i>

    <!-- John Burkardt -->

  </body>

</html>

